<div class="container">
  <h1 class="h1" style="text-align:left; margin-bottom:14px;"><%= category.name %></h1>

  <div class="products">
    <% products.forEach(p => { %>
      <div class="product-card">
        <div class="img-wrap">
          <img src="<%= p.image_url %>" alt="<%= p.name %>">
        </div>

        <div class="product-info">
          <div class="product-title"><%= p.name %></div>
          <div class="product-price">ราคา: <b><%= Number(p.price).toFixed(2) %></b> บาท</div>

          <form class="product-actions" action="/cart/add" method="POST">
            <input type="hidden" name="product_id" value="<%= p.id %>">

            <div class="qty-box">
              <button type="button" class="qty-btn minus">−</button>
              <input type="text" class="qty-input" name="qty" value="1" readonly>
              <button type="button" class="qty-btn plus">+</button>
            </div>

            <button type="submit" class="btn primary">หยิบใส่ตะกร้า</button>
          </form>
        </div>
      </div>
    <% }) %>
  </div>
</div>

<script>
  // ทำงานเฉพาะหน้านี้: ปุ่ม +/- เปลี่ยนจำนวนใน input
  document.querySelectorAll(".product-card").forEach((card) => {
    const minus = card.querySelector(".qty-btn.minus");
    const plus  = card.querySelector(".qty-btn.plus");
    const input = card.querySelector(".qty-input");

    minus.addEventListener("click", () => {
      let v = Number(input.value || 1);
      v = Math.max(1, v - 1);
      input.value = String(v);
    });

    plus.addEventListener("click", () => {
      let v = Number(input.value || 1);
      v = v + 1;
      input.value = String(v);
    });
  });
</script>
